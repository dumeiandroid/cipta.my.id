<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <title>Profil Pemeriksaan Psikologis</title>
    <style>
        body {
            color: black;
            font-family: Arial, sans-serif;
            margin: 0;
            background-color: #7000E0;
            /*background-image: url('https://placehold.co/1920x1080/7000E0/FFFFFF?text=Latar+Belakang');*/
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 0;
        }
        .container1, .container_a {
            color: black;
            background: white;
            width: 280mm;
            padding: 20px;
            background-color: white;
            border: 1px solid black;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin: 20px auto;
            position: relative;
        }
        .container1 {
            height: 370mm;
        }
        .container_a {
            height: 365mm;
            overflow: hidden;
        }
        .container_a::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('../test/admin/gambar/logo1.png');
            background-size: 70%;
            background-position: center;
            background-repeat: no-repeat;
            opacity: 0.1;
            z-index: 0;
        }
        .container_a > * {
            position: relative;
            z-index: 1;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            border-top: 3px double black;
            border-bottom: 3px double black;
        }
        th, td {
            padding: 8px;
            border: 1px solid black;
        }
        th {
            text-align: center;
        }
        td {
            text-align: left;
        }
        .header {
            background-color: #f2f2f2;
        }
        .strength-weakness {
            margin-top: 20px;
        }
        .signature {
            margin-top: 20px;
            text-align: right;
        }
        .highlight {
            background-color: #d1e7dd;
            font-size: 16px;
            margin: 0;
            padding: 0;
            text-align: center;
        }
        .no-inner-borders td {
            border: none;
        }
        .section-header {
            font-weight: bold;
            color: white;
            background-color: black;
            text-align: center;
        }
        .custom-header {
            display: grid;
            grid-template-columns: auto 1fr;
            align-items: center;
            margin-bottom: 20px;
            background-color: #5F4EDA;
            padding: 10px;
            border-radius: 8px;
        }
        .logo-container_a {
            margin-right: 10px;
        }
        .logo {
            width: 130px;
            height: auto;
        }
        .info-container_a {
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-left: -80px;
        }
        .header-title {
            font-size: 24px;
            font-weight: bold;
            color: white;
            margin: 2px 0;
        }
        .header-subtitle {
            font-size: 18px;
            font-style: italic;
            color: #e0f7fa;
            margin: 2px 0;
        }
        .location, .address, .phone, .website {
            margin: 2px 0;
            color: white;
        }
        .custom-table {
            border-collapse: collapse;
            width: 100%;
        }
        .custom-table td {
            padding: 5px;
            margin: 0;
        }
        .custom-list {
            margin-left: 10px;
            margin-top: 5px;
            padding: 0;
            list-style-position: inside;
        }
        #downloadBtn {
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        @media print {
            body {
                background: white;
            }
            .container1, .container_a {
                box-shadow: none;
                border: none;
                margin: 0;
            }
            #downloadBtn {
                display: none;
            }
        }
    </style>
</head>
<body>

    <div class="batas-download" id="downloadContent1">
        <div class="container1">
            <div class="custom-header no-download" style="background-color: #5F4EDA;">
                    <div class="logo-container_a">
                        <img src="../test/admin/gambar/logo1.png" alt="Logo" class="logo"/>
                    </div>
                    <div class="info-container_a">
                        <div class="header-title" style="color: white; font-size: 24px; font-weight: bold;">PT. LIDAN INDAH ABADI</div>
                        <div class="header-subtitle" style="color: #e0f7fa; font-size: 18px; font-style: italic;">LIDAN PSIKOLOGI</div>
                        <div class="location" style="color: white;">Regus Forum Nine, Lantai 9 CIMB NIAGA PLAZA</div>
                        <div class="address" style="color: white;">Jalan Imam Bonjol No.9, Medan 20159, Sumatera Utara</div>
                        <div class="phone" style="color: white;">Telepon: +62851-5960-1400</div>
                        <div class="website" style="color: #e0f7fa;">
                            Website: <a href="http://www.lidan.co.id" style="color: #e0f7fa; text-decoration: underline;">www.lidan.co.id</a>, Email: 
                            <a href="mailto:cs@lidan.co.id" style="color: #e0f7fa; text-decoration: underline;">cs@lidan.co.id</a>
                        </div>
                    </div>
                </div>
            <h2 style="text-align: center;">PROFIL PEMERIKSAAN PSIKOLOGIS</h2>
            <table class="no-inner-borders custom-table">
                <tr>
                    <td style="width: 200px; border-left: none;">Nama</td>
                    <td style="width: 20px;">:</td>
                    <td style="border-right: none;" id="nama"></td>
                </tr>
                <tr>
                    <td style="border-left: none;">Jenis Kelamin</td>
                    <td>:</td>
                    <td style="border-right: none;" id="jenis_kelamin"></td>
                </tr>
                <tr>
                    <td style="border-left: none;">Usia</td>
                    <td>:</td>
                    <td style="border-right: none;" id="usia"></td>
                </tr>
                <tr>
                    <td style="border-left: none;">Pendidikan</td>
                    <td>:</td>
                    <td style="border-right: none;" id="pendidikan"></td>
                </tr>
                <tr>
                    <td style="border-left: none;">Posisi</td>
                    <td>:</td>
                    <td style="border-right: none;" id="posisi"></td>
                </tr>
                <tr>
                    <td style="border-left: none;">Tanggal Pemeriksaan</td>
                    <td>:</td>
                    <td style="border-right: none;" id="tanggal_pemeriksaan"></td>
                </tr>
                <tr>
                    <td style="border-left: none;">Tujuan Pemeriksaan</td>
                    <td>:</td>
                    <td style="border-right: none;" id="tujuan_pemeriksaan"></td>
                </tr>
            </table>
            <h3 style="text-align: center;">Aspek Psikologis</h3>
            <table id="aspek-psikologis-table">
                <thead>
                    <tr class="header">
                        <th rowspan="2" style="width: 250px; vertical-align: top;">Aspek Psikologis</th>
                        <th rowspan="2" style="width: 400px; vertical-align: top;">Keterangan</th>
                        <th colspan="10">Skala</th>
                    </tr>
                    <tr class="header1">
                        <th colspan="4">K</th>
                        <th colspan="2">C</th>
                        <th colspan="2">B</th>
                        <th colspan="2">BS</th>
                    </tr>
                </thead>
                <tbody id="aspek-psikologis-body">
                    <!-- Rows will be generated by JavaScript -->
                </tbody>
            </table>
            <br>
            *Keterangan : K = Kurang ; C = Cukup ; B = Baik ; BS = Baik Sekali
        </div>
    </div>

    <div class="batas-download" id="downloadContent2">
        <div class="container_a">
            <div class="strength-weakness">
                <div><strong>Intelligence Quotient (IQ) :</strong></div>
                <ul class="custom-list">
                    <li id="iq-value"></li>
                </ul>
                <div><strong>Strengths/Kelebihan:</strong></div>
                <ul class="custom-list" id="strengths-list">
                    <!-- Strengths will be generated by JavaScript -->
                </ul>
                <div><strong>Weaknesses/Kelemahan:</strong></div>
                <ul class="custom-list" id="weaknesses-list">
                    <!-- Weaknesses will be generated by JavaScript -->
                </ul>
                <div><strong>Recommendation/Rekomendasi:</strong></div>
                <ul class="custom-list" id="recommendations-list">
                    <!-- Recommendations will be generated by JavaScript -->
                </ul>
                <h4 style="text-decoration: underline;">Arah Minat Pendidikan / Pekerjaan</h4>
                <ul class="custom-list" id="minat-list">
                    <!-- Minat will be generated by JavaScript -->
                </ul>
            </div>
            <br>
            <div class="signature">
                <p><strong id="signature-date">Medan, </strong></p>
                <p style="margin-top: -12px;">Psikolog,</p>
                <img src="../test/admin/gambar/ttd.png" alt="Psychologist Image" style="max-width: 20%; height: auto;"/>
                <p style="margin-top: -5px;"><strong>Dr. Karina M. Brahmana, M.Psi, Psikolog</strong></p>
                <p style="margin-top: -12px;">No SIPP: 20070136-2021-02-0799</p><br>
                
    <img class="no-download" src="../test/admin/gambar/medsos.png" alt="Psychologist Image" style="max-width: 20%; height: auto;"/>
            </div>
        </div>
    </div>

    <button id="downloadBtn">Download PDF</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script>
        // Jalankan semua skrip setelah halaman selesai dimuat
        window.onload = function() {
            // =================================================================
            // DATA DARI PHP DIUBAH MENJADI VARIABEL JAVASCRIPT
            // =================================================================

            const x_10 = ';;;|;;;;;;;;;;;;;|;;|;;|;;|;;|;;';
            const x_02 = 'Roy Vivianna Nindy; Jl Namorambe Deli tua;Deliserdang;1981-01-01;20;1;Indonesia;Belum menikah;Laki-laki | 08112109876;contoh18@gmail.com;https://lidan.co.id;https://lidan.co.id;https://lidan.co.id;https://lidan.co.id | Sumatera Utara;Ekonomi;Perbankan;2020;2024;2.45;S1 | Sekretaris;Klub Penulis;2021;Mengelola kegiatan penulisan dan penerbitan karya;Ketua;Komunitas Olahraga Mahasiswa;2023;Mengelola kegiatan olahraga di kampus | 10;9;9;8;8;9 | Kemampuan komunikasi saya yang baik memungkinkan saya untuk menjalin hubungan yang positif dengan orang lain, baik di dalam maupun di luar lingkungan kerja. | jjj19 | Supervisor;PT Konstruksi Utama;2022-2023;Mengawasi proyek konstruksi dan keselamatan;Manager;PT Bangun Bersama;2023;Mengelola anggaran dan sumber daya proyek | pernah';
            const x_06 = 'A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A;A||6;11;12;8;9;7;4;5;2;3;10;1|2;9;1;4;3;10;6;7;8;5;11;12|11;8;3;1;12;9;7;6;5;10;4;2|9;10;12;2;6;8;4;7;11;3;1;5|5;11;12;8;7;10;3;4;1;2;6;9|5;9;8;7;10;11;4;6;3;2;12;1|8;5;2;1;12;9;10;7;11;6;3;4|11;5;6;8;10;1;12;9;7;4;3;2||||';
            const x_05 = '5|4|10|6||||||||||||30||10|||||||||||||||||||||||||||||||||||||||||||';

            const minat = [
                { "arah_minat": "OUTDOOR", "singkatan": "OUT", "keterangan_minat": "Minat ini melibatkan berbagai aktivitas yang dilakukan di luar ruangan, seperti kegiatan outbound yang meningkatkan keterampilan tim, travelling untuk menjelajahi tempat-tempat baru, dan eksplorasi pertambangan yang memberikan wawasan tentang sumber daya alam serta teknik penambangan." },
                { "arah_minat": "LITERATURE", "singkatan": "LITE", "keterangan_minat": "Bidang ini berfokus pada literatur dan berbagai karya tulis, mencakup profesi seperti ahli perpustakaan yang bertanggung jawab untuk mengelola koleksi buku, serta petugas administrasi yang mendukung organisasi dan penyebaran informasi dalam institusi literasi." },
                { "arah_minat": "MECHANICAL", "singkatan": "MECH", "keterangan_minat": "Minat ini terkait dengan ilmu mekanik dan teknik, yang mencakup berbagai disiplin seperti teknik mesin yang merancang dan memproduksi mesin, serta teknik sipil yang merencanakan dan membangun infrastruktur seperti jembatan dan gedung." },
                { "arah_minat": "MUSICAL", "singkatan": "MUS", "keterangan_minat": "Minat di bidang musik ini mencakup kemampuan untuk menciptakan, memainkan, atau menginterpretasikan karya musik, yang bisa termasuk profesi seperti komposer yang merangkai melodi serta pemain musik yang tampil di berbagai acara dan pertunjukan." },
                { "arah_minat": "COMPUTATIONAL", "singkatan": "COMP", "keterangan_minat": "Bidang ini berfokus pada keterampilan analisis dan perhitungan, mencakup profesi seperti akuntan yang bertanggung jawab untuk pencatatan dan pelaporan keuangan, serta ahli pembukuan yang mengelola catatan transaksi untuk bisnis dan organisasi." },
                { "arah_minat": "SOCIAL SERVICE", "singkatan": "SOS. WERV", "keterangan_minat": "Minat ini berkaitan dengan pelayanan sosial dan komunitas, mencakup peran sebagai sukarelawan yang memberikan bantuan kepada yang membutuhkan, pekerja sosial yang membantu individu dan keluarga dalam kesulitan, serta psikolog yang memberikan dukungan mental dan emosional." },
                { "arah_minat": "SCIENTIFIC", "singkatan": "ACIE", "keterangan_minat": "Minat di bidang scientific ini melibatkan penelitian dan eksperimen untuk mengembangkan pengetahuan baru, mencakup profesi seperti peneliti yang melakukan studi ilmiah dan ahli matematika yang menerapkan teori matematika dalam berbagai aplikasi praktis." },
                { "arah_minat": "CLERICAL", "singkatan": "CLER", "keterangan_minat": "Bidang ini berfokus pada keterampilan administratif dan organisasi, mencakup peran sebagai sekretaris yang mengelola jadwal dan dokumen, serta notulen yang mendokumentasikan rapat dan kegiatan penting dalam suatu organisasi." },
                { "arah_minat": "PERSUASIVE", "singkatan": "PERS", "keterangan_minat": "Minat ini berhubungan dengan kemampuan berkomunikasi dan mempengaruhi orang lain, mencakup profesi seperti ahli komunikasi yang merancang strategi komunikasi efektif, serta marketing yang mempromosikan produk dan layanan kepada konsumen." },
                { "arah_minat": "PRACTICAL", "singkatan": "PRAC", "keterangan_minat": "Minat ini berfokus pada keterampilan praktis dan teknis, mencakup peran sebagai montir yang memperbaiki dan merawat kendaraan, serta ahli perbaikan mesin yang menangani berbagai masalah teknis pada peralatan dan alat-alat industri." },
                { "arah_minat": "AESTHETIC", "singkatan": "AESTH", "keterangan_minat": "Minat ini mencakup kemampuan kreatif dalam seni dan desain, termasuk profesi seperti pelukis yang menciptakan karya seni visual, seniman patung yang membuat patung dari berbagai bahan, serta arsitek yang merancang bangunan dengan mempertimbangkan fungsi dan estetika." },
                { "arah_minat": "MEDICAL", "singkatan": "MED", "keterangan_minat": "Minat ini berkaitan dengan bidang medis dan kesehatan, mencakup profesi seperti dokter yang mendiagnosis dan merawat penyakit, perawat yang memberikan perawatan langsung kepada pasien, serta ahli kesehatan yang berfokus pada pencegahan penyakit dan promosi kesehatan." }
            ];

            const kekuatan_kelemahan = [
                { "teks1": "Kemampuan Umum", "teks2": "Mampu menemukan solusi untuk berbagai masalah dengan efektif.", "teks3": "Kesulitan menghadapi masalah yang sangat kompleks.", "teks4": "Analisis Kebijakan dan Manajemen Proyek, di mana kemampuan untuk mengatasi masalah sangat dihargai.", "teks5": "Disarankan untuk melatih kemampuan pemecahan masalah dengan mengikuti simulasi kasus kompleks dan berpartisipasi dalam diskusi kelompok, sehingga dapat meningkatkan ketahanan dalam menghadapi tantangan yang lebih besar." },
                { "teks1": "Daya Tangkap Visual", "teks2": "Cepat mengenali pola dan perbedaan di lingkungan sekitar.", "teks3": "Kurang perhatian terhadap detail yang lebih kecil, yang mempengaruhi hasil akhir.", "teks4": "Desain Grafis atau Analisis Data, di mana kemampuan visual sangat diperlukan.", "teks5": "Sangat dianjurkan untuk mempraktikkan teknik mindfulness yang dapat membantu meningkatkan fokus terhadap detail kecil, sehingga hasil kerja dapat lebih maksimal dan akurat." },
                { "teks1": "Kemampuan Berpikir Logis", "teks2": "Mampu membuat keputusan berdasarkan alasan yang jelas dalam situasi tertentu.", "teks3": "Kesulitan membuat keputusan cepat dalam situasi mendesak.", "teks4": "Bidang pekerjaan yang tepat adalah Pengembangan Software atau Riset Pasar, yang membutuhkan pemikiran logis yang tajam.", "teks5": "Sebaiknya mengikuti pelatihan khusus yang dirancang untuk pengambilan keputusan di bawah tekanan, agar dapat meningkatkan kecepatan dan ketepatan dalam mengambil keputusan ketika situasi mendesak." },
                { "teks1": "Kemampuan Berpikir Abstrak", "teks2": "Mampu melihat hubungan antara berbagai hal dan memahami konsekuensi dari tindakan.", "teks3": "Tantangan dalam menerjemahkan ide-ide abstrak ke dalam praktik.", "teks4": "Bidang pekerjaan yang relevan adalah Konsultasi Strategis atau Inovasi Produk, yang memanfaatkan pemikiran kreatif.", "teks5": "Disarankan untuk melakukan proyek kecil yang akan membantu menerapkan ide-ide abstrak ke dalam praktik nyata, sehingga dapat belajar dari pengalaman dan meningkatkan kemampuan penerapan ide." },
                { "teks1": "Penalaran Verbal", "teks2": "Mampu berkomunikasi dengan jelas dan efektif dalam interaksi.", "teks3": "Kurang sabar dalam mendengarkan pandangan orang lain, yang menghambat komunikasi.", "teks4": "Pemasaran atau Hubungan Masyarakat, di mana komunikasi yang baik sangat penting.", "teks5": "Sangat bermanfaat untuk melatih keterampilan mendengarkan aktif melalui kegiatan role-playing, yang dapat meningkatkan kemampuan untuk menghargai pandangan orang lain dan memperbaiki komunikasi." },
                { "teks1": "Penalaran Numerik", "teks2": "Kemampuan memahami proses hitung dan berpikir teratur.", "teks3": "Memerlukan waktu lebih lama untuk memahami konsep matematika yang lebih rumit.", "teks4": "Akuntansi atau Analisis Keuangan, yang membutuhkan ketelitian dalam angka.", "teks5": "Disarankan untuk berlatih secara rutin dengan soal-soal matematika yang lebih kompleks, agar dapat meningkatkan kecepatan dan pemahaman dalam konsep yang rumit." },
                { "teks1": "Hasrat Berprestasi", "teks2": "Keinginan untuk mencapai dan meningkatkan prestasi.", "teks3": "Beban ekspektasi tinggi dapat memengaruhi fokus dan kinerja.", "teks4": "Manajemen Proyek atau Pengembangan Bisnis, di mana prestasi diakui dan dihargai.", "teks5": "Sangat penting untuk menetapkan tujuan yang realistis dan melakukan evaluasi berkala, agar dapat menjaga motivasi dan fokus pada pencapaian yang lebih terukur." },
                { "teks1": "Daya Tahan Stress", "teks2": "Kemampuan mempertahankan kinerja.", "teks3": "Kewalahan saat menghadapi tekanan yang berkepanjangan.", "teks4": "Bidang pekerjaan yang tepat adalah Konsultasi atau Manajemen Sumber Daya Manusia, yang sering kali memerlukan ketahanan terhadap stres.", "teks5": "Sebaiknya mempraktikkan teknik relaksasi dan manajemen waktu yang efektif, sehingga dapat mengurangi stres dan meningkatkan performa dalam menghadapi tekanan." },
                { "teks1": "Kepercayaan Diri", "teks2": "Adanya keyakinan terhadap kemampuan yang dimiliki.", "teks3": "Kurang terbuka terhadap kritik konstruktif, yang menghambat perkembangan.", "teks4": "Bidang pekerjaan yang relevan adalah Pelatihan atau Kepemimpinan, di mana kepercayaan diri sangat berpengaruh.", "teks5": "Disarankan untuk secara rutin meminta umpan balik dari orang lain, sehingga dapat membangun kepercayaan diri yang lebih solid dan meningkatkan kemampuan untuk menerima kritik." },
                { "teks1": "Relasi Sosial", "teks2": "Kemampuan membina hubungan dengan orang lain.", "teks3": "Canggung dalam situasi sosial baru, yang menghambat interaksi.", "teks4": "Pengembangan Komunitas atau Pemasaran, yang memerlukan keterampilan membangun hubungan.", "teks5": "Sangat dianjurkan untuk bergabung dengan kelompok sosial atau komunitas yang diminati, sehingga dapat berlatih keterampilan interaksi dan membangun hubungan yang lebih baik." },
                { "teks1": "Kerjasama", "teks2": "Kemampuan bekerjasama individu atau berkelompok.", "teks3": "Kesulitan beradaptasi dengan dinamika kelompok yang berbeda.", "teks4": "Proyek Tim atau Manajemen Operasi, di mana kerjasama sangat penting.", "teks5": "Disarankan untuk terlibat dalam berbagai aktivitas kelompok yang memerlukan kolaborasi, agar dapat meningkatkan kemampuan untuk beradaptasi dengan berbagai dinamika kelompok." },
                { "teks1": "Sistematika Kerja", "teks2": "Kemampuan membuat perencanaan & prioritas kerja.", "teks3": "Terlalu fokus pada perencanaan, sehingga mengabaikan implementasi.", "teks4": "Bidang pekerjaan yang tepat adalah Manajemen Proyek atau Perencanaan Strategis, yang memerlukan keterampilan organisasi.", "teks5": "Sebaiknya tentukan batas waktu untuk setiap fase implementasi, agar tidak terjebak dalam perencanaan yang berlarut-larut dan dapat segera memulai eksekusi." },
                { "teks1": "Inisiatif", "teks2": "Kemampuan mengambil tindakan yang diperlukan.", "teks3": "Pengambilan keputusan yang terburu-buru berisiko tinggi.", "teks4": "Kewirausahaan atau Pengembangan Produk, di mana inisiatif sangat dihargai.", "teks5": "Disarankan untuk selalu mempertimbangkan pro dan kontra secara mendalam sebelum mengambil keputusan, agar dapat mengurangi risiko yang mungkin timbul dari keputusan yang terburu-buru." },
                { "teks1": "Kemandirian", "teks2": "Kemampuan mengambil sikap dan bekerja sendiri.", "teks3": "Kesulitan dalam berkolaborasi dengan tim, yang dapat memengaruhi hasil kerja.", "teks4": "Freelancing atau Penulisan Kreatif, di mana kemandirian adalah keunggulan.", "teks5": "Sangat penting untuk terlibat dalam proyek kolaboratif yang dapat membantu meningkatkan keterampilan kerja sama dan beradaptasi dalam lingkungan tim." }
            ];

            // =================================================================
            // LOGIKA DARI PHP DIUBAH MENJADI FUNGSI JAVASCRIPT
            // =================================================================

            // --- Parsing Data Awal ---
            const parts_x10 = x_10.split('|').map(part => part.trim().split(';'));
            let hasil10 = parts_x10;
            let result = parts_x10;

            const parts_x02 = x_02.split('|').map(part => part.trim().split(';'));
            const nama = parts_x02;

            const x6_parts = x_06.split('|');
            const soal_epps = x6_parts[0].split(';');

            const usia = parseFloat(nama[0][4]);

            // --- Skoring RMIB ---
            const result_rmib = x6_parts.slice(2, 10).join(';');
            const soal_rmib = result_rmib.split(';');

            const p = (index) => parseInt(soal_rmib[index - 1].trim()) || 0;

            const out = p(1) + p(24) + p(35) + p(46) + p(57) + p(68) + p(79) + p(90);
            const mech = p(2) + p(13) + p(36) + p(47) + p(58) + p(69) + p(80) + p(91);
            const comp = p(3) + p(14) + p(25) + p(48) + p(59) + p(70) + p(81) + p(92);
            const acie = p(4) + p(15) + p(26) + p(37) + p(60) + p(71) + p(82) + p(93);
            const pers = p(5) + p(16) + p(27) + p(38) + p(49) + p(72) + p(83) + p(94);
            const aesth = p(6) + p(17) + p(28) + p(39) + p(50) + p(61) + p(84) + p(95);
            const lite = p(7) + p(18) + p(29) + p(40) + p(51) + p(62) + p(73) + p(96);
            const mus = p(8) + p(19) + p(30) + p(41) + p(52) + p(63) + p(74) + p(85);
            const sos_wer = p(9) + p(20) + p(31) + p(42) + p(53) + p(64) + p(75) + p(86);
            const cler = p(10) + p(21) + p(32) + p(43) + p(54) + p(65) + p(76) + p(87);
            const prac = p(11) + p(22) + p(33) + p(44) + p(55) + p(66) + p(77) + p(88);
            const med = p(12) + p(23) + p(34) + p(45) + p(56) + p(67) + p(78) + p(89);

            let totals_rmib = {
                "OUT": out, "MECH": mech, "COMP": comp, "ACIE": acie, "PERS": pers,
                "AESTH": aesth, "LITE": lite, "MUS": mus, "SOS. WERV": sos_wer,
                "CLER": cler, "PRAC": prac, "MED": med
            };

            // --- Fungsi Helper ---
            function getScore(value, criteria) {
                for (const limit in criteria) {
                    if (value <= parseInt(limit)) {
                        return criteria[limit];
                    }
                }
                return Object.values(criteria).pop();
            }

            // --- Kriteria Skoring ---
            const iqCriteria = { 60: 1, 69: 2, 79: 3, 89: 4, 99: 5, 109: 6, 119: 7, 129: 8, 139: 9, [Number.MAX_SAFE_INTEGER]: 10 };
            const cfitCriteria = { 2: 1, 3: 2, 4: 3, 5: 4, 7: 5, 8: 6, 9: 7, 10: 8, 11: 9, 13: 10 };
            const tkd3Criteria = { 12: 1, 16: 2, 20: 3, 23: 4, 27: 5, 31: 6, 35: 7, 38: 8, 40: 9, [Number.MAX_SAFE_INTEGER]: 10 };
            const tkd6Criteria = { 2: 1, 5: 2, 9: 3, 12: 4, 16: 5, 19: 6, 23: 7, 26: 8, 30: 9, [Number.MAX_SAFE_INTEGER]: 10 };
            const achCriteria = { 2: 1, 4: 2, 6: 3, 8: 4, 10: 5, 12: 6, 14: 7, 16: 8, 18: 9, [Number.MAX_SAFE_INTEGER]: 10 };

            // --- Skoring CFIT ---
            const nilai_x05 = x_05.split('|');
            const CFIT1 = parseInt(nilai_x05[0].trim()) || 0;
            const CFIT2 = parseInt(nilai_x05[1].trim()) || 0;
            const CFIT3 = parseInt(nilai_x05[2].trim()) || 0;
            const CFIT4 = parseInt(nilai_x05[3].trim()) || 0;
            const skorTotal_cfit = CFIT1 + CFIT2 + CFIT3 + CFIT4;

            function getIQ_cfit(skorTotal, usia) {
                const iqTable = {
                    49: [183, 183, 183, 183, 183], 48: [183, 183, 183, 179, 179], 47: [183, 183, 179, 176, 176], 46: [183, 179, 176, 173, 173], 45: [179, 176, 173, 169, 169], 44: [176, 173, 169, 167, 167], 43: [175, 171, 168, 165, 165], 42: [171, 168, 165, 161, 161], 41: [167, 163, 160, 157, 157], 40: [165, 161, 159, 155, 155], 39: [161, 159, 155, 152, 152], 38: [159, 155, 152, 149, 149], 37: [155, 152, 149, 145, 145], 36: [152, 149, 145, 142, 142], 35: [150, 147, 144, 140, 140], 34: [147, 144, 140, 137, 137], 33: [142, 139, 136, 133, 133], 32: [140, 137, 134, 131, 131], 31: [137, 134, 131, 128, 128], 30: [134, 131, 128, 126, 124], 29: [131, 128, 124, 123, 121], 28: [129, 126, 123, 121, 119], 27: [126, 123, 119, 117, 116], 26: [123, 119, 116, 114, 113], 25: [119, 116, 113, 111, 109], 24: [116, 113, 109, 108, 106], 23: [113, 109, 106, 104, 103], 22: [109, 106, 103, 101, 100], 21: [106, 103, 100, 98, 96], 20: [104, 101, 98, 96, 94], 19: [101, 98, 94, 93, 91], 18: [98, 94, 91, 89, 88], 17: [94, 91, 88, 86, 85], 16: [91, 88, 85, 83, 81], 15: [88, 85, 81, 80, 78], 14: [85, 81, 78, 76, 75], 13: [81, 78, 75, 73, 72], 12: [80, 76, 73, 72, 70], 11: [76, 73, 70, 68, 67], 10: [73, 70, 67, 65, 63], 9: [70, 67, 63, 62, 60], 8: [67, 63, 60, 58, 57], 7: [63, 60, 57, 56, 55], 6: [60, 57, 55, 53, 52], 5: [57, 55, 53, 51, 48], 4: [55, 54, 52, 50, 47], 3: [53, 52, 48, 47, 45], 2: [52, 51, 47, 46, 43], 1: [50, 50, 46, 45, 40], 0: [48, 48, 45, 43, 38],
                };
                let ageIndex;
                if (usia >= 13.0 && usia <= 13.4) ageIndex = 0;
                else if (usia >= 13.5 && usia <= 13.11) ageIndex = 1;
                else if (usia >= 14.0 && usia <= 14.11) ageIndex = 2;
                else if (usia >= 15.0 && usia <= 15.11) ageIndex = 3;
                else if (usia >= 16.0) ageIndex = 4;
                else return "Usia tidak valid";
                return iqTable[skorTotal] ? iqTable[skorTotal][ageIndex] : "Skor total tidak valid";
            }
            
            const iq_from_cfit = getIQ_cfit(skorTotal_cfit, usia);
            const IQ = parseInt(hasil10[0][3]) || iq_from_cfit;

            const tkd3 = parseInt(nilai_x05[15]) || 0;
            const tkd6 = parseInt(nilai_x05[17]) || 0;

            // --- Skoring EPPS ---
            const e = (index) => soal_epps[index - 1];
            const ach_r = [e(6), e(11), e(16), e(21), e(26), e(31), e(36), e(41), e(46), e(51), e(56), e(61), e(66), e(71)];
            const def_r = [e(2), e(12), e(17), e(22), e(27), e(32), e(37), e(42), e(47), e(52), e(57), e(62), e(67), e(72)];
            const ord_r = [e(3), e(8), e(18), e(23), e(28), e(33), e(38), e(43), e(48), e(53), e(58), e(63), e(68), e(73)];
            const exh_r = [e(4), e(9), e(14), e(24), e(29), e(34), e(39), e(44), e(49), e(54), e(59), e(64), e(69), e(74)];
            const aut_r = [e(5), e(10), e(15), e(20), e(30), e(35), e(40), e(45), e(50), e(55), e(60), e(65), e(70), e(75)];
            const aff_r = [e(76), e(81), e(86), e(91), e(96), e(106), e(111), e(116), e(121), e(126), e(131), e(136), e(141), e(146)];
            const int_r = [e(77), e(82), e(87), e(92), e(97), e(102), e(112), e(117), e(122), e(127), e(132), e(137), e(142), e(147)];
            const suc_r = [e(78), e(83), e(88), e(93), e(98), e(103), e(108), e(118), e(123), e(128), e(133), e(138), e(143), e(148)];
            const dom_r = [e(79), e(84), e(89), e(94), e(99), e(104), e(109), e(114), e(124), e(129), e(134), e(139), e(144), e(149)];
            const aba_r = [e(80), e(85), e(90), e(95), e(100), e(105), e(110), e(115), e(120), e(130), e(135), e(140), e(145), e(150)];
            const nur_r = [e(151), e(156), e(161), e(166), e(171), e(176), e(181), e(186), e(191), e(196), e(206), e(211), e(216), e(221)];
            const chg_r = [e(152), e(157), e(162), e(167), e(172), e(177), e(182), e(187), e(192), e(197), e(202), e(212), e(217), e(222)];
            const end_r = [e(153), e(158), e(163), e(168), e(173), e(178), e(183), e(188), e(193), e(198), e(203), e(208), e(218), e(223)];
            const het_r = [e(154), e(159), e(164), e(169), e(174), e(179), e(184), e(189), e(194), e(199), e(204), e(209), e(214), e(224)];
            const agg_r = [e(155), e(160), e(165), e(170), e(175), e(180), e(185), e(190), e(195), e(200), e(205), e(210), e(215), e(220)];

            const ach_c = [e(2), e(3), e(4), e(5), e(76), e(77), e(78), e(79), e(80), e(151), e(152), e(153), e(154), e(155)];
            const def_c = [e(6), e(8), e(9), e(10), e(81), e(82), e(83), e(84), e(85), e(156), e(157), e(158), e(159), e(160)];
            const ord_c = [e(11), e(12), e(14), e(15), e(86), e(87), e(88), e(89), e(90), e(161), e(162), e(163), e(164), e(165)];
            const exh_c = [e(16), e(17), e(18), e(20), e(91), e(92), e(93), e(94), e(95), e(166), e(167), e(168), e(169), e(170)];
            const aut_c = [e(21), e(22), e(23), e(24), e(96), e(97), e(98), e(99), e(100), e(171), e(172), e(173), e(174), e(175)];
            const aff_c = [e(26), e(27), e(28), e(29), e(30), e(102), e(103), e(104), e(105), e(176), e(177), e(178), e(179), e(180)];
            const int_c = [e(31), e(32), e(33), e(34), e(35), e(106), e(108), e(109), e(110), e(181), e(182), e(183), e(184), e(185)];
            const suc_c = [e(36), e(37), e(38), e(39), e(40), e(111), e(112), e(114), e(115), e(186), e(187), e(188), e(189), e(190)];
            const dom_c = [e(41), e(42), e(43), e(44), e(45), e(116), e(117), e(118), e(120), e(191), e(192), e(193), e(194), e(195)];
            const aba_c = [e(46), e(47), e(48), e(49), e(50), e(121), e(122), e(123), e(124), e(196), e(197), e(198), e(199), e(200)];
            const nur_c = [e(51), e(52), e(53), e(54), e(55), e(126), e(127), e(128), e(129), e(130), e(202), e(203), e(204), e(205)];
            const chg_c = [e(56), e(57), e(58), e(59), e(60), e(131), e(132), e(133), e(134), e(135), e(206), e(208), e(209), e(210)];
            const end_c = [e(61), e(62), e(63), e(64), e(65), e(136), e(137), e(138), e(139), e(140), e(211), e(212), e(214), e(215)];
            const het_c = [e(66), e(67), e(68), e(69), e(70), e(141), e(142), e(143), e(144), e(145), e(216), e(217), e(218), e(220)];
            const agg_c = [e(71), e(72), e(73), e(74), e(75), e(146), e(147), e(148), e(149), e(150), e(221), e(222), e(223), e(224)];

            const count = (arr, val) => arr.filter(item => item === val).length;

            const ach_s = count(ach_r, 'A') + count(ach_c, 'B');
            const def_s = count(def_r, 'A') + count(def_c, 'B');
            const ord_s = count(ord_r, 'A') + count(ord_c, 'B');
            const exh_s = count(exh_r, 'A') + count(exh_c, 'B');
            const out_s = count(aut_r, 'A') + count(aut_c, 'B');
            const aff_s = count(aff_r, 'A') + count(aff_c, 'B');
            const int_s = count(int_r, 'A') + count(int_c, 'B');
            const suc_s = count(suc_r, 'A') + count(suc_c, 'B');
            const dom_s = count(dom_r, 'A') + count(dom_c, 'B');
            const aba_s = count(aba_r, 'A') + count(aba_c, 'B');
            const nur_s = count(nur_r, 'A') + count(nur_c, 'B');
            const chg_s = count(chg_r, 'A') + count(chg_c, 'B');
            const end_s = count(end_r, 'A') + count(end_c, 'B');
            const het_s = count(het_r, 'A') + count(het_c, 'B');
            const agg_s = count(agg_r, 'A') + count(agg_c, 'B');

            let konsistensi = 0;
            if (e(1) == e(151)) konsistensi++; if (e(7) == e(157)) konsistensi++;
            if (e(13) == e(163)) konsistensi++; if (e(19) == e(169)) konsistensi++;
            if (e(25) == e(175)) konsistensi++; if (e(26) == e(101)) konsistensi++;
            if (e(32) == e(107)) konsistensi++; if (e(38) == e(113)) konsistensi++;
            if (e(44) == e(119)) konsistensi++; if (e(50) == e(125)) konsistensi++;
            if (e(51) == e(201)) konsistensi++; if (e(57) == e(207)) konsistensi++;
            if (e(63) == e(213)) konsistensi++; if (e(69) == e(219)) konsistensi++;
            if (e(75) == e(225)) konsistensi++;

            function getWS(ss, type_s) {
                const mapping = {
                    'ACH_s': { 28: 20, 27: 20, 26: 19, 25: 18, 24: 17, 23: 16, 22: 16, 21: 15, 20: 14, 19: 13, 18: 12, 17: 11, 16: 10, 15: 9, 14: 8, 13: 7, 12: 6, 11: 5, 10: 5, 9: 4, 8: 3, 7: 2, 6: 1, 5: 0, 4: 0, 3: 0, 2: 0, 1: 0, 0: 0 },
                    'DEF_s': { 22: 20, 21: 19, 20: 18, 19: 18, 18: 18, 17: 17, 16: 16, 15: 15, 14: 14, 13: 13, 12: 11, 11: 11, 10: 10, 9: 9, 8: 8, 7: 7, 6: 6, 5: 5, 4: 3, 3: 3, 2: 2, 1: 1, 0: 0 },
                    'ORD_s': { 28: 20, 27: 19, 26: 19, 25: 18, 24: 17, 23: 17, 22: 16, 21: 15, 20: 15, 19: 14, 18: 13, 17: 13, 16: 12, 15: 11, 14: 10, 13: 9, 12: 9, 11: 8, 10: 7, 9: 7, 8: 6, 7: 5, 6: 5, 5: 4, 4: 3, 3: 3, 2: 2, 1: 1, 0: 1 },
                    'EXH_s': { 24: 20, 23: 19, 22: 18, 21: 18, 20: 17, 19: 16, 18: 15, 17: 15, 16: 14, 15: 13, 14: 12, 13: 11, 12: 10, 11: 9, 10: 8, 9: 7, 8: 7, 7: 6, 6: 5, 5: 4, 4: 3, 3: 3, 2: 2, 1: 1, 0: 0 },
                    'OUT_s': { 21: 20, 20: 19, 19: 18, 18: 17, 17: 16, 16: 15, 15: 14, 14: 13, 13: 12, 12: 11, 11: 10, 10: 9, 9: 8, 8: 7, 7: 6, 6: 5, 5: 4, 4: 3, 3: 2, 2: 2, 1: 1, 0: 0 },
                    'AFF_s': { 26: 20, 25: 19, 24: 19, 23: 18, 22: 17, 21: 16, 20: 15, 19: 14, 18: 14, 17: 13, 16: 12, 15: 11, 14: 10, 13: 9, 12: 8, 11: 8, 10: 7, 9: 6, 8: 5, 7: 4, 6: 3, 5: 3, 4: 2, 3: 1, 2: 1, 1: 0 },
                    'INT_s': { 28: 20, 27: 20, 26: 19, 25: 18, 24: 17, 23: 17, 22: 16, 21: 15, 20: 14, 19: 14, 18: 13, 17: 12, 16: 11, 15: 10, 14: 9, 13: 8, 12: 7, 11: 7, 10: 6, 9: 5, 8: 4, 7: 4, 6: 3, 5: 2, 4: 1, 3: 1, 2: 0, 1: 0 },
                    'SUC_s': { 27: 20, 26: 19, 25: 19, 24: 18, 23: 17, 22: 17, 21: 16, 20: 15, 19: 15, 18: 14, 17: 13, 16: 13, 15: 12, 14: 11, 13: 10, 12: 9, 11: 9, 10: 8, 9: 7, 8: 7, 7: 6, 6: 5, 5: 4, 4: 4, 3: 3, 2: 2, 1: 1, 0: 1 },
                    'DOM_s': { 25: 20, 24: 20, 23: 19, 22: 18, 21: 17, 20: 17, 19: 16, 18: 15, 17: 14, 16: 14, 15: 13, 14: 12, 13: 11, 12: 10, 11: 9, 10: 8, 9: 8, 8: 7, 7: 6, 6: 5, 5: 5, 4: 4, 3: 3, 2: 2, 1: 1, 0: 0 },
                    'ABA_s': { 29: 20, 28: 19, 27: 18, 26: 18, 25: 17, 24: 16, 23: 15, 22: 15, 21: 14, 20: 13, 19: 13, 18: 12, 17: 11, 16: 10, 15: 9, 14: 8, 13: 8, 12: 7, 11: 6, 10: 5, 9: 5, 8: 4, 7: 3, 6: 2, 5: 2, 4: 1, 3: 0, 2: 0, 1: 0 },
                    'NUR_s': { 30: 20, 29: 19, 28: 18, 27: 18, 26: 17, 25: 16, 24: 16, 23: 15, 22: 14, 21: 14, 20: 13, 19: 12, 18: 12, 17: 11, 16: 10, 15: 10, 14: 9, 13: 8, 12: 8, 11: 7, 10: 6, 9: 6, 8: 5, 7: 4, 6: 4, 5: 3, 4: 2, 3: 2, 2: 1, 1: 0, 0: 0 },
                    'CHG_s': { 27: 20, 26: 19, 25: 18, 24: 18, 23: 17, 22: 16, 21: 16, 20: 15, 19: 14, 18: 13, 17: 13, 16: 12, 15: 11, 14: 10, 13: 9, 12: 9, 11: 8, 10: 7, 9: 6, 8: 6, 7: 5, 6: 4, 5: 3, 4: 3, 3: 2, 2: 1, 1: 1, 0: 0 },
                    'END_s': { 30: 20, 29: 19, 28: 18, 27: 17, 26: 17, 25: 16, 24: 16, 23: 15, 22: 14, 21: 14, 20: 13, 19: 13, 18: 12, 17: 12, 16: 11, 15: 10, 14: 9, 13: 9, 12: 8, 11: 7, 10: 7, 9: 6, 8: 6, 7: 5, 6: 4, 5: 4, 4: 3, 3: 3, 2: 2, 1: 1, 0: 1 },
                    'HET_s': { 26: 20, 25: 19, 24: 19, 23: 18, 22: 18, 21: 17, 20: 17, 19: 16, 18: 16, 17: 15, 16: 15, 15: 14, 14: 14, 13: 13, 12: 12, 11: 12, 10: 11, 9: 11, 8: 10, 7: 9, 6: 9, 5: 8, 4: 8, 3: 7, 2: 7, 1: 6, 0: 5 },
                    'AGG_s': { 27: 20, 26: 19, 25: 18, 24: 18, 23: 17, 22: 16, 21: 16, 20: 15, 19: 14, 18: 14, 17: 13, 16: 12, 15: 12, 14: 11, 13: 10, 12: 9, 11: 9, 10: 8, 9: 7, 8: 7, 7: 6, 6: 5, 5: 5, 4: 4, 3: 3, 2: 3, 1: 2, 0: 1 },
                };
                return mapping[type_s][ss] !== undefined ? mapping[type_s][ss] : null;
            }

            const ACH = getWS(ach_s, 'ACH_s');
            const DOM = getWS(dom_s, 'DOM_s');
            const AUT = getWS(out_s, 'OUT_s');
            const EXH = getWS(exh_s, 'EXH_s');
            const AFF = getWS(aff_s, 'AFF_s');
            const DEF = getWS(def_s, 'DEF_s');
            const ORD = getWS(ord_s, 'ORD_s');

            // --- Menghitung Skor Akhir ---
            result[1][0] = getScore(IQ, iqCriteria);
            result[1][1] = getScore(CFIT2, cfitCriteria);
            result[1][2] = getScore((CFIT1 + CFIT4) / 2, cfitCriteria);
            result[1][3] = getScore(CFIT3, cfitCriteria);
            result[1][4] = getScore(tkd3, tkd3Criteria);
            result[1][5] = getScore(tkd6, tkd6Criteria);
            result[1][6] = getScore(ACH, achCriteria);
            result[1][7] = getScore((DOM + ACH + AUT) / 3, achCriteria);
            result[1][8] = getScore(EXH, achCriteria);
            result[1][9] = getScore(AFF, achCriteria);
            result[1][10] = getScore(DEF, achCriteria);
            result[1][11] = getScore(ORD, achCriteria);
            result[1][12] = getScore((DOM + ACH + AUT) / 3, achCriteria);
            result[1][13] = getScore(AUT, achCriteria);

            // Mengganti nilai result jika ada di hasil10
            for (let i = 0; i <= 13; i++) {
                if (hasil10[1][i] && parseInt(hasil10[1][i]) !== 0) {
                    result[1][i] = parseInt(hasil10[1][i]);
                }
            }
            
            // Membuat array berindeks untuk diurutkan
            const indexed_array = result[1].map((value, index) => ({ value, index }));

            // =================================================================
            // POPULASI DATA KE HTML (MANIPULASI DOM)
            // =================================================================

            // --- Mengisi Info Personal ---
            document.getElementById('nama').textContent = nama[0][0];
            document.getElementById('jenis_kelamin').textContent = nama[0][8];
            document.getElementById('usia').textContent = nama[0][4];
            document.getElementById('pendidikan').textContent = `${nama[2][6]} ${nama[2][1]}`;
            document.getElementById('posisi').textContent = result[0][0];
            document.getElementById('tanggal_pemeriksaan').textContent = result[0][1] || '';
            document.getElementById('tujuan_pemeriksaan').textContent = result[0][2] || '';
            document.getElementById('signature-date').textContent += result[0][1] || '';

            // --- Mengisi Tabel Aspek Psikologis ---
            const aspekBody = document.getElementById('aspek-psikologis-body');
            const aspekData = [
                { header: 'KEMAMPUAN' },
                { title: 'Kemampuan Umum', desc: 'Mampu menemukan solusi untuk berbagai masalah dengan efektif.', scoreIndex: 0 },
                { title: 'Daya Tangkap Visual', desc: 'Cepat mengenali pola dan perbedaan di lingkungan sekitar.', scoreIndex: 1 },
                { title: 'Kemampuan Berpikir Logis', desc: 'Mampu membuat keputusan berdasarkan alasan yang jelas dalam situasi tertentu.', scoreIndex: 2 },
                { title: 'Kemampuan Berpikir Abstrak', desc: 'Mampu melihat hubungan antara berbagai hal dan memahami konsekuensi dari tindakan.', scoreIndex: 3 },
                { title: 'Penalaran Verbal', desc: 'Mampu berkomunikasi dengan jelas dan efektif dalam interaksi.', scoreIndex: 4 },
                { title: 'Penalaran Numerik', desc: 'Kemampuan memahami proses hitung dan berpikir teratur', scoreIndex: 5 },
                { header: 'KEPRIBADIAN' },
                { title: 'Hasrat Berprestasi', desc: 'Keinginan untuk mencapai dan meningkatkan prestasi', scoreIndex: 6 },
                { title: 'Daya Tahan Stress', desc: 'Kemampuan mempertahankan kinerja', scoreIndex: 7 },
                { title: 'Kepercayaan Diri', desc: 'Adanya keyakinan terhadap kemampuan yang dimiliki', scoreIndex: 8 },
                { title: 'Relasi Sosial', desc: 'Kemampuan membina hubungan dengan orang lain', scoreIndex: 9 },
                { title: 'Kerjasama', desc: 'Kemampuan bekerjasama individu atau berkelompok', scoreIndex: 10 },
                { header: 'SIKAP KERJA' },
                { title: 'Sistematika Kerja', desc: 'Kemampuan membuat perencanaan & prioritas kerja', scoreIndex: 11 },
                { title: 'Inisiatif', desc: 'Kemampuan mengambil tindakan yang diperlukan', scoreIndex: 12 },
                { title: 'Kemandirian', desc: 'Kemampuan mengambil sikap dan bekerja sendiri', scoreIndex: 13 },
            ];

            aspekData.forEach(item => {
                const row = document.createElement('tr');
                if (item.header) {
                    row.innerHTML = `<td colspan="12" class="section-header">${item.header}</td>`;
                } else {
                    let cells = `<td>${item.title}</td><td>${item.desc}</td>`;
                    const score = result[1][item.scoreIndex];
                    for (let i = 1; i <= 10; i++) {
                        if (score === i) {
                            cells += `<td class="highlight">✔</td>`;
                        } else {
                            cells += `<td></td>`;
                        }
                    }
                    row.innerHTML = cells;
                }
                aspekBody.appendChild(row);
            });

            // --- Mengisi Halaman Kedua ---
            document.getElementById('iq-value').textContent = `Intelligence Quotient / IQ = ${IQ}`;

            // --- Kelebihan ---
            const strengthsList = document.getElementById('strengths-list');
            indexed_array.sort((a, b) => b.value - a.value); // Urutkan dari terbesar
            for (let i = 0; i < 3; i++) {
                const value = (hasil10[2] && hasil10[2][i] && hasil10[2][i].trim()) ? hasil10[2][i].trim() : kekuatan_kelemahan[indexed_array[i].index].teks2;
                strengthsList.innerHTML += `<li>${value}</li>`;
            }

            // --- Kelemahan ---
            const weaknessesList = document.getElementById('weaknesses-list');
            indexed_array.sort((a, b) => a.value - b.value); // Urutkan dari terkecil
            for (let i = 0; i < 3; i++) {
                const value = (hasil10[3] && hasil10[3][i] && hasil10[3][i].trim()) ? hasil10[3][i].trim() : kekuatan_kelemahan[indexed_array[i].index].teks3;
                weaknessesList.innerHTML += `<li>${value}</li>`;
            }

            // --- Rekomendasi ---
            const recommendationsList = document.getElementById('recommendations-list');
            indexed_array.sort((a, b) => b.value - a.value); // Urutkan dari terbesar lagi
            for (let i = 0; i < 3; i++) {
                const value = (hasil10[4] && hasil10[4][i] && hasil10[4][i].trim()) ? hasil10[4][i].trim() : kekuatan_kelemahan[indexed_array[i].index].teks5;
                recommendationsList.innerHTML += `<li>${value}</li>`;
            }

            // --- Arah Minat ---
            const minatList = document.getElementById('minat-list');
            const sortedMinat = Object.entries(totals_rmib).sort(([, a], [, b]) => a - b);
            const smallestTotals = sortedMinat.slice(0, 5);

            smallestTotals.forEach((item, j) => {
                const key = item[0];
                const minatItem = minat.find(m => m.singkatan === key);
                if (minatItem) {
                    const arahMinatValue = (hasil10[5] && hasil10[5][j] && hasil10[5][j].trim()) ? hasil10[5][j].trim().toUpperCase() : minatItem.arah_minat;
                    const keteranganValue = (hasil10[6] && hasil10[6][j] && hasil10[6][j].trim()) ? hasil10[6][j].trim() : minatItem.keterangan_minat;
                    minatList.innerHTML += `<li><strong>${arahMinatValue}</strong><br>Keterangan: ${keteranganValue}</li>`;
                }
            });

            // --- Fungsi Download PDF ---
            document.getElementById('downloadBtn').onclick = function() {
                const { jsPDF } = window.jspdf;
                const doc = new jsPDF('p', 'mm', 'a4');
                const imgWidth = doc.internal.pageSize.getWidth();
                const pageHeight = doc.internal.pageSize.getHeight();

                const noDownloadElements = document.querySelectorAll('.no-download');
                noDownloadElements.forEach(el => el.style.display = 'none');
                
                const headerImgSrc = 'https://placehold.co/210x30/5F4EDA/FFFFFF?text=Header+Laporan';
                const footerImgSrc = 'https://placehold.co/210x30/5F4EDA/FFFFFF?text=Footer+Laporan';

                const processPage = (contentId, isFirstPage) => {
                    return new Promise((resolve) => {
                         if (!isFirstPage) {
                            doc.addPage();
                        }
                        
                        const headerImg = new Image();
                        headerImg.crossOrigin = "anonymous";
                        headerImg.src = headerImgSrc;
                        headerImg.onload = () => {
                            doc.addImage(headerImg, 'PNG', 0, 0, imgWidth, 30);
                            
                            const content = document.getElementById(contentId);
                            html2canvas(content, { scale: 2, useCORS: true }).then(canvas => {
                                const imgData = canvas.toDataURL('image/png');
                                const contentHeight = (canvas.height * imgWidth) / canvas.width;
                                doc.addImage(imgData, 'PNG', 0, 30, imgWidth, contentHeight);

                                const footerImg = new Image();
                                footerImg.crossOrigin = "anonymous";
                                footerImg.src = footerImgSrc;
                                footerImg.onload = () => {
                                    doc.addImage(footerImg, 'PNG', 0, pageHeight - 30, imgWidth, 30);
                                    resolve();
                                };
                            });
                        };
                    });
                };

                processPage('downloadContent1', true)
                    .then(() => processPage('downloadContent2', false))
                    .then(() => {
                        doc.save('profil_pemeriksaan_psikologis.pdf');
                        noDownloadElements.forEach(el => el.style.display = '');
                    });
            };
        };
    </script>
</body>
</html>
