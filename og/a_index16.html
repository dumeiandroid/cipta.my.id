<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Generator Otomatis Penyemangat Harian - Lidan Psikologi (Desember 2025)</title>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 40px;
            max-width: 1300px;
            width: 100%;
        }

        h1 {
            color: #333;
            margin-bottom: 10px;
            font-size: 28px;
        }

        .subtitle {
            color: #666;
            margin-bottom: 30px;
            font-size: 14px;
        }

        .controls {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            flex-direction: column;
        }

        label {
            color: #555;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 14px;
        }

        input[type="number"],
        input[type="url"],
        select,
        textarea,
        input[type="text"] {
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        input[type="number"]:focus,
        input[type="url"]:focus,
        select:focus,
        textarea:focus,
        input[type="text"]:focus {
            outline: none;
            border-color: #667eea;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
            grid-column: 1 / -1;
        }

        input[type="color"] {
            width: 60px;
            height: 40px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }

        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            height: 10px;
            background: #e0e0e0;
            border-radius: 5px;
            cursor: pointer;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #667eea;
            border-radius: 50%;
            cursor: pointer;
        }


        .canvas-container {
            background: #f5f5f5;
            border-radius: 12px;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
            overflow: auto;
        }

        canvas {
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            max-width: 100%;
            height: auto;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .section-title {
            color: #333;
            font-size: 18px;
            font-weight: 700;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #667eea;
            grid-column: 1 / -1;
        }

        .help-text {
            color: #888;
            font-size: 12px;
            margin-top: 4px;
        }

        @media (max-width: 768px) {
            .controls {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>âœ¨ Generator Otomatis Penyemangat Harian - Lidan Psikologi</h1>
        <p class="subtitle">Membuat **31 gambar** pesan penyemangat otomatis untuk **Desember 2025**. Background diacak & dilengkapi sistem **Retry Otomatis**.</p>

        <div class="controls">
            <div class="section-title">ğŸ¨ Pengaturan Tampilan</div>
            
            <div class="input-group">
                <label>Ukuran Font (Pesan Utama):</label>
                <input type="number" id="fontSizeEn" value="48" min="20" max="150">
            </div>

            <div class="input-group">
                <label>Ukuran Font (Tanggal):</label>
                <input type="number" id="fontSizeId" value="28" min="15" max="100">
                <span class="help-text">Mengatur ukuran font untuk hari, tanggal, bulan, dan tahun.</span>
            </div>

            <div class="input-group">
                <label>Warna Teks:</label>
                <input type="color" id="textColor" value="#ffffff">
            </div>
            
            <div class="input-group">
                <label>Warna Shadow Teks:</label>
                <input type="color" id="shadowColor" value="#000000">
                <span class="help-text">Tambahkan shadow untuk visibilitas.</span>
            </div>

            <div class="section-title">ğŸ–¼ï¸ Pengaturan Background</div>

            <div class="input-group">
                <label>Kontras Gambar Background (0.5 - 2.0):</label>
                <input type="number" id="bgContrast" value="1.0" min="0.5" max="2.0" step="0.1">
                <span class="help-text">1.0 = normal. Mengatur tingkat kontras.</span>
            </div>
            
            <div class="input-group">
                <label>Warna Gambar Background (Hue Rotate):</label>
                <input type="range" id="bgHue" value="0" min="0" max="360" step="1">
                <span class="help-text">0 = normal. Memutar rona warna (dalam derajat).</span>
            </div>
            
            <div class="section-title">ğŸ·ï¸ Pengaturan Logo & Branding</div>
            
            <div class="input-group">
                <label>URL Logo:</label>
                <input type="url" id="logoUrl" value="https://cipta.my.id/og/gambar/logo-psikologi.png" placeholder="https://example.com/logo.png">
                <span class="help-text">Masukkan URL logo (akan muncul di kanan atas)</span>
            </div>

            <div class="input-group">
                <label>Teks Brand:</label>
                <input type="text" id="brandText" value="Lidan Psikologi" placeholder="Nama Brand">
            </div>

            <div class="input-group">
                <label>Ukuran Logo:</label>
                <input type="number" id="logoSize" value="60" min="30" max="150">
                <span class="help-text">Ukuran logo dalam piksel.</span>
            </div>
        </div>

        <div class="canvas-container">
            <canvas id="canvas" width="1200" height="630"></canvas>
        </div>

        <div class="button-group">
            <button onclick="updatePreview(0)">ğŸ”„ Update Preview (Hari ke-1)</button>
            <button onclick="downloadAllImages()">â¬‡ï¸ Generate & Download 31 Gambar ZIP (Desember 2025)</button> 
        </div>

        <p id="statusMessage" style="text-align: center; margin-top: 20px; font-weight: bold; color: #333;"></p>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const DEFAULT_WIDTH = 1200;
        const DEFAULT_HEIGHT = 630;
        const MAX_RETRIES = 3; 
        const PICSUM_MAX_ID = 1000; // Batas ID untuk pengacakan Picsum

        canvas.width = DEFAULT_WIDTH;
        canvas.height = DEFAULT_HEIGHT;

        let logoImage = new Image();
        let logoLoaded = false;
        
        // --- Setup Awal Logo ---
        const logoUrlInput = document.getElementById('logoUrl');
        logoImage.crossOrigin = 'Anonymous'; 
        logoImage.src = logoUrlInput.value;
        logoImage.onload = function() {
            logoLoaded = true;
            updatePreview(0); 
        };
        logoImage.onerror = function() {
            logoLoaded = false;
            updatePreview(0);
        };
        logoUrlInput.addEventListener('change', function() {
            const url = this.value.trim();
            if (url) {
                logoLoaded = false;
                logoImage.src = url;
            } else {
                logoLoaded = false;
                updatePreview(0);
            }
        });
        // --- Akhir Setup Awal Logo ---

        /**
         * FUNGSI UNTUK MENGHASILKAN DATA 31 HARI DIMULAI 1 DESEMBER 2025
         */
        function generateDecember2025Data() {
             // Pool Pesan Khusus Istirahat (Diprioritaskan setiap hari Minggu)
            const restMessages = [
                "Hari ini adalah izin resmi Anda untuk tidak produktif. Istirahat adalah bagian dari proses.",
                "Self-care bukanlah kemewahan, tapi kebutuhan. Isi ulang energi Anda hari ini.",
                "Jangan meremehkan kekuatan satu hari penuh tanpa agenda. Biarkan pikiran Anda mengembara.",
                "Biarkan hari Minggu menjadi hari di mana Anda pulih, bukan hari di mana Anda mengejar ketertinggalan.",
                "Jeda hari ini akan memastikan langkah Anda besok lebih kuat. Prioritaskan ketenangan.",
                "Heningkan diri. Kedamaian seringkali ditemukan saat kita berhenti mencari dan mulai menerima.",
                "Hari libur adalah waktu untuk merayakan siapa diri Anda, bukan apa yang telah Anda capai.",
                "Matikan notifikasi. Sambungkan kembali dengan diri Anda sendiri dan orang-orang terkasih.",
                "Ambillah waktu untuk sekadar bernapas dan menerima momen ini sepenuhnya.",
                "Minggu adalah hari untuk memanjakan jiwa Anda. Beri apa yang ia butuhkan untuk menyembuhkan.",
            ];

            // Pool Pesan Harian Baru (140+ pesan unik)
            const dailyMessages = [
                "Fokus pada kemajuan, bukan kesempurnaan. Langkah kecil hari ini membawa Anda lebih dekat.",
                "Keberanian adalah bertindak meskipun ada rasa takut. Anda lebih berani dari yang Anda kira.",
                "Ubah rasa cemas menjadi perencanaan. Kendalikan apa yang bisa Anda kendalikan.",
                "Kenali batasan Anda. Batasan yang jelas adalah bentuk penghormatan diri.",
                "Pikiran adalah alat, bukan tuan Anda. Pelajari cara mengarahkan perhatian.",
                "Setiap hari adalah peluang untuk menulis ulang cerita Anda, terlepas dari bab kemarin.",
                "Anda tidak bisa menuang dari cangkir kosong. Jaga diri Anda terlebih dahulu.",
                "Kualitas hidup Anda berbanding lurus dengan kualitas pertanyaan yang Anda ajukan pada diri sendiri.",
                "Jangan mencari kebahagiaan di luar; kebahagiaan dimulai dari penerimaan diri di dalam.",
                "Proses penyembuhan adalah seni melepaskan apa yang tidak lagi melayani Anda.",
                "Jangan biarkan kritik internal merampas keunikan dan potensi Anda.",
                "Masa lalu adalah pelajaran, bukan hukuman. Ambil hikmahnya dan bergerak maju.",
                "Ambil napas dalam-dalam. Solusi seringkali datang dalam ketenangan, bukan kekacauan.",
                "Jadilah lebih ingin tahu daripada menghakimi, baik terhadap diri sendiri maupun orang lain.",
                "Ketidakpastian adalah bagian dari kehidupan. Berlatihlah untuk merasa nyaman dengan 'tidak tahu'.",
                "Komitmen kecil yang konsisten akan selalu mengalahkan niat besar yang sporadis.",
                "Bukan beban yang menghancurkan Anda, tetapi cara Anda membawanya.",
                "Hargai proses transformasi. Ulat tidak menjadi kupu-kupu dalam sehari.",
                "Hadiah dari ketekunan bukanlah hasil akhir, tetapi versi diri Anda yang terbentuk selama proses.",
                "Prioritas yang jelas adalah kompas menuju ketenangan mental.",
                "Anda tidak perlu menanggung beban orang lain. Berikan dukungan, bukan tanggung jawab.",
                "Belajarlah untuk membiarkan hal-hal yang tidak penting berlalu begitu saja.",
                "Pilih pertumbuhan di atas kenyamanan. Di situlah keajaiban terjadi.",
                "Keluar dari siklus *overthinking* dengan berfokus pada tindakan kecil yang segera.",
                "Emosi adalah data, bukan perintah. Ambil informasi dan putuskan respons Anda.",
                "Saat merasa terisolasi, ingatlah bahwa kerentanan adalah jembatan menuju koneksi.",
                "Jadikan rasa syukur sebagai kebiasaan. Itu mengubah apa yang kita lihat.",
                "Terimalah bahwa beberapa hari akan sulit. Itu tidak membuat Anda gagal.",
                "Kekuatan terbesar Anda adalah kemampuan untuk memulai lagi, seberapa pun seringnya Anda jatuh.",
                "Bicara pada diri sendiri dengan kebaikan yang sama seperti Anda berbicara pada sahabat.",
                "Jangan biarkan rasa takut kehilangan menghentikan Anda dari mencoba hal baru.",
                "Keberhasilan sejati adalah selaras dengan nilai-nilai Anda, bukan standar orang lain.",
                "Anda sudah bertahan dari 100% hari terburuk Anda sejauh ini. Anda tangguh.",
                "Ciptakan batasan digital. Lindungi ruang mental Anda dari kebisingan media sosial.",
                "Fokus pada energi yang Anda bawa, bukan pada energi yang Anda temui.",
                "Jika Anda terus menunggu kesempurnaan, Anda tidak akan pernah mulai.",
                "Waktu yang Anda habiskan untuk khawatir adalah waktu yang terbuang dari hidup Anda.",
                "Jadilah pendengar yang lebih baik bagi suara batin Anda.",
                "Hidup adalah seni menyeimbangkan melepaskan dan menggenggam erat.",
                "Cari tahu apa yang menjadi penguras energi Anda dan minimalkan paparan terhadapnya.",
                "Kekuatan untuk mengubah dunia Anda dimulai dengan mengubah pikiran Anda.",
                "Jangan biarkan 'apa yang terjadi' menutupi 'apa yang bisa terjadi'.",
                "Ubah 'Saya harus' menjadi 'Saya memilih untuk'. Ini adalah pemberdayaan.",
                "Setiap kegagalan adalah pelatihan yang mahal. Pastikan Anda mendapat nilai darinya.",
                "Berhenti membandingkan bab pertama Anda dengan bab kesepuluh orang lain.",
                "Perubahan adalah satu-satunya konstanta. Belajarlah untuk mengalir bersamanya.",
                "Beri diri Anda izin untuk bersinar tanpa harus meredupkan cahaya orang lain.",
                "Jangan menunda sukacita. Momen kecil hari ini layak untuk dirayakan.",
                "Rasa bersalah yang tidak perlu adalah beban berat. Lepaskan, maafkan, lanjutkan.",
                "Disiplin bukanlah hukuman, tetapi cinta diri yang terwujud dalam tindakan.",
                "Ciptakan rutinitas yang mendukung, bukan rutinitas yang membatasi.",
                "Anda tidak bertanggung jawab atas interpretasi orang lain terhadap tindakan Anda.",
                "Kembangkan kebiasaan, bukan hanya niat. Kebiasaanlah yang membentuk Anda.",
                "Terkadang, langkah paling produktif adalah berdiam diri dan berpikir.",
                "Kehadiran penuh di momen ini adalah obat untuk sebagian besar kecemasan.",
                "Jangan biarkan hal-hal kecil menguasai pikiran Anda. Jaga perspektif.",
                "Hargai proses kecil yang Anda butuhkan untuk mencapai tujuan besar.",
                "Jika Anda ingin mengubah buahnya, Anda harus mengubah akarnya.",
                "Belajarlah untuk menikmati perjalanan menuju tujuan, bukan hanya tujuan itu sendiri.",
                "Ucapkan terima kasih pada diri sendiri atas usaha dan ketahanan Anda.",
                "Tentukan tiga prioritas teratas Anda hari ini dan abaikan yang lainnya.",
                "Ingat, Anda adalah orang dewasa. Anda memiliki sumber daya untuk menyelesaikan ini.",
                "Ambil keputusan yang didasarkan pada harapan, bukan ketakutan.",
                "Kejujuran pada diri sendiri adalah dasar dari semua pertumbuhan psikologis.",
                "Kebaikan yang kecil bisa menciptakan efek domino positif yang besar.",
                "Jangan mencari solusi yang sempurna. Cari solusi yang cukup baik untuk hari ini.",
                "Pahami perbedaan antara melepaskan dan menyerah.",
                "Anda tidak perlu bukti eksternal untuk memvalidasi nilai Anda.",
                "Kekuatan emosional adalah kemampuan untuk merasakan tanpa dikendalikan.",
                "Jadikan diri Anda alasan untuk tersenyum saat Anda melihat ke cermin.",
                "Rangkul kelemahan Anda. Di situlah letak potensi pertumbuhan Anda.",
                "Fokus pada apa yang Anda tambahkan ke dunia, bukan hanya apa yang Anda ambil.",
                "Tujuan yang jelas membuat rintangan terlihat kecil.",
                "Terlalu banyak pilihan bisa melumpuhkan. Pilih saja satu arah.",
                "Jadilah arsitek kehidupan Anda, bukan sekadar penghuninya.",
                "Tinggalkan zona nyaman Anda. Keajaiban tidak akan menunggu Anda di sana.",
                "Pilih respons, bukan reaksi. Jeda singkat adalah kekuatan Anda.",
                "Kepercayaan diri adalah otot. Latih setiap hari dengan tindakan kecil.",
                "Beranilah untuk memulai hal baru meskipun Anda merasa belum siap.",
                "Jangan biarkan rasa takut akan kegagalan menghentikan percobaan yang berpotensi mengubah hidup.",
                "Berhenti mencari pembenaran. Cukup lakukan apa yang Anda tahu benar.",
                "Menciptakan kedamaian batin adalah pekerjaan harian.",
                "Kualitas hubungan Anda menentukan kualitas hidup Anda. Investasi pada yang bermakna.",
                "Setiap hari adalah latihan untuk menjadi versi diri Anda yang lebih baik.",
                "Jangan biarkan pikiran Anda menjadi tempat yang buruk untuk dihuni. Bersihkan kekacauan mental.",
                "Belajarlah untuk menunda kepuasan. Hadiah jangka panjang jauh lebih berharga.",
                "Ukur keberhasilan Anda dengan ketenangan pikiran, bukan dengan harta benda.",
                "Hari ini, lepaskan beban ekspektasi yang tidak realistis.",
                "Perhatikan kapan Anda merasa paling bersemangat. Lakukan lebih banyak hal itu.",
                "Jangan biarkan rasa malu menahan Anda dari meminta bantuan atau nasihat.",
                "Kemajuan adalah proses berulang. Terima putaran maju dan mundur.",
                "Terima kekurangan Anda; mereka adalah bagian dari humanitas Anda.",
                "Katakan 'ya' pada peluang yang membuat jantung Anda berdetak lebih cepat.",
                "Latih rasa ingin tahu Anda. Dunia penuh dengan hal-hal yang belum Anda ketahui.",
                "Pahami bahwa penolakan hanyalah pengalihan, bukan penentuan nilai.",
                "Ambil kendali atas narasi hidup Anda. Anda adalah penulis, bukan korban.",
                "Jangan biarkan masa lalu merampas energi yang Anda butuhkan untuk masa kini.",
                "Jadikan perhatian penuh (mindfulness) sebagai senjata rahasia Anda melawan stres.",
                "Kebaikan yang Anda berikan kepada diri sendiri adalah yang pertama Anda berikan kepada orang lain.",
                "Fokuslah pada dampak kecil yang dapat Anda buat setiap hari.",
                "Berhenti menunggu motivasi. Disiplin adalah jembatan yang membawa Anda melintas.",
                "Hidup bukan tentang menemukan diri sendiri, tetapi tentang menciptakan diri sendiri.",
                "Setiap kesulitan mengandung benih manfaat. Carilah benih itu.",
                "Bersikaplah lembut pada diri sendiri. Anda melakukan yang terbaik dengan apa yang Anda miliki.",
                "Rasa syukur yang tulus adalah jalan tercepat menuju kebahagiaan.",
                "Jangan biarkan keraguan diri menjadi penghalang terbesar Anda.",
                "Anda layak mendapatkan waktu, energi, dan fokus terbaik Anda.",
                "Pilih kedamaian di atas drama, setiap saat.",
                "Kekuatan untuk mengubah segalanya ada dalam momen sekarang.",
                "Biarkan diri Anda dimaafkan, terutama oleh diri Anda sendiri.",
                "Jangan mencari kebahagiaan di tempat yang Anda kehilangannya.",
                "Belajarlah untuk merayakan siapa Anda di tengah proses menjadi.",
                "Kehidupan adalah serangkaian 'sekarang'. Hadir sepenuhnya di yang ini.",
                "Apa yang paling Anda takutkan untuk dikatakan adalah apa yang perlu Anda dengar.",
                "Tantang pikiran negatif Anda. Apakah itu fakta atau hanya fiksi?",
                "Ambil waktu untuk melihat sekeliling. Kecantikan ada di mana-mana.",
                "Kecepatan tidak sepenting arah yang benar.",
                "Ingat, Anda tidak harus menjelaskan diri Anda kepada siapa pun.",
                "Pilihlah untuk fokus pada solusi, bukan masalah.",
                "Jangan biarkan 'bagaimana jika' merampas 'apa yang bisa'.",
                "Bangunlah dengan niat dan tidurlah dengan kepuasan.",
                "Hari ini, putuskan untuk menjadi lebih baik, bukan sempurna.",
                "Kemandirian emosional adalah mengetahui bahwa Anda bisa menenangkan diri sendiri.",
                "Jangan biarkan ambisi menghancurkan kebahagiaan harian Anda.",
                "Ciptakan ruang untuk hal-hal baik datang ke dalam hidup Anda.",
                "Beri diri Anda waktu untuk berduka dan merasakan. Itu adalah proses yang valid.",
                "Pahami bahwa tidak semua orang harus menyukai Anda, dan itu baik-baik saja.",
                "Jadilah sumber cahaya di dunia. Mulai dari diri sendiri.",
                "Tindakan kecil dengan konsistensi menciptakan hasil besar yang luar biasa.",
                "Jangan pernah kompromikan kesehatan mental Anda demi pekerjaan atau ambisi.",
                "Kekuatan sejati adalah kelembutan pada diri sendiri.",
                "Berhentilah memikirkan kegagalan; mulailah membayangkan kesuksesan.",
                "Gunakan kritik sebagai cermin, bukan sebagai palu.",
                "Anda tidak bisa mengontrol akhir cerita, tapi Anda bisa mengontrol bagaimana Anda menulisnya.",
                "Hari ini, jadilah berani untuk menjadi rentan.",
                "Pilih lingkungan yang mendukung pertumbuhan Anda, bukan yang menghambatnya.",
                "Keberhasilan adalah hasil dari persiapan dan kesempatan yang bertemu.",
                "Anda layak mendapatkan cinta diri dan rasa hormat tanpa syarat.",
                "Lakukan satu hal yang membuat Anda takut hari ini.",
                "Hargai keunikan perjalanan Anda. Itu adalah peta yang hanya Anda miliki.",
                "Kemajuan, bukan kesempurnaan, adalah yang membuat hidup berharga.",
                "Perlakukan tubuh Anda dengan baik. Itu adalah rumah mental Anda.",
                "Kendalikan pikiran Anda atau pikiran Anda yang akan mengendalikan Anda.",
                "Ubah 'Saya takut' menjadi 'Saya bersemangat untuk mencoba'.",
                "Jadilah pahlawan dalam cerita Anda sendiri.",
                "Jangan biarkan penyesalan hari ini mencuri kedamaian hari esok.",
                "Pilihlah apa yang meningkatkan energi Anda, bukan yang menurunkannya.",
                "Kekuatan untuk bangkit ada di dalam diri Anda. Temukan itu.",
                "Terima semua bagian dari diri Anda, yang baik dan yang tidak sempurna.",
                "Ambil langkah pertama. Itu adalah bagian tersulit dari setiap perjalanan.",
                "Jadikan istirahat sebagai janji yang tidak boleh dilanggar.",
                "Ketenangan batin adalah kekayaan terbesar Anda."
            ];

            const messages = [];
            // Mulai dari 1 Desember 2025
            const startDate = new Date('2025-12-01T12:00:00Z'); 
            
            // Opsi format tanggal Indonesia
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };

            // 31 hari di bulan Desember
            const daysInMonth = 31;
            let dailyMessageCounter = 0;
            let restMessageCounter = 0;
            
            for (let i = 0; i < daysInMonth; i++) {
                const currentDate = new Date(startDate);
                currentDate.setDate(startDate.getDate() + i);

                // Format tanggal Indonesia
                const formatter = new Intl.DateTimeFormat('id-ID', options);
                const dateString = formatter.format(currentDate);
                
                let selectedMessage;
                // Cek hari: 0 = Minggu (Sunday)
                if (currentDate.getDay() === 0) {
                    // Jika Hari Minggu, pilih dari pool restMessages
                    selectedMessage = restMessages[restMessageCounter % restMessages.length];
                    restMessageCounter++;
                } else {
                    // Jika Hari Kerja, pilih dari pool dailyMessages
                    selectedMessage = dailyMessages[dailyMessageCounter % dailyMessages.length]; 
                    dailyMessageCounter++;
                }

                messages.push({
                    message: selectedMessage, 
                    date: dateString 
                });
            }
            
            return messages;
        }

        /**
         * FUNGSI HELPER UNTUK MENGACAK DAN MEMUAT GAMBAR DENGAN RETRY
         */

        // Fungsi untuk menghasilkan URL Picsum acak
        function generateRandomImageUrl(width, height) {
            const newId = Math.floor(Math.random() * PICSUM_MAX_ID) + 1;
            return `https://picsum.photos/id/${newId}/${width}/${height}`;
        }

        // Fungsi untuk menghasilkan daftar 31 ID Picsum acak unik
        function generateRandomPicsumIds(count) {
            const ids = new Set();
            while (ids.size < count) {
                ids.add(Math.floor(Math.random() * PICSUM_MAX_ID) + 1);
            }
            return Array.from(ids);
        }

        /**
         * Memuat gambar dengan mekanisme coba ulang (retry) jika gagal.
         * @param {string} initialUrl URL gambar awal.
         * @returns {Promise<HTMLImageElement | null>} Promise yang mengembalikan objek Image yang berhasil dimuat, atau null jika gagal total.
         */
        function loadImageWithRetry(initialUrl) {
            return new Promise((resolve) => {
                let attempts = 0;
                let currentUrl = initialUrl;

                const attemptLoad = () => {
                    attempts++;
                    const image = new Image();
                    image.crossOrigin = 'Anonymous';
                    image.src = currentUrl;

                    image.onload = () => resolve(image);

                    image.onerror = () => {
                        if (attempts < MAX_RETRIES) {
                            // Coba lagi dengan URL acak yang berbeda
                            currentUrl = generateRandomImageUrl(DEFAULT_WIDTH, DEFAULT_HEIGHT);
                            console.warn(`Gagal memuat gambar dari URL: ${image.src}. Mencoba lagi (Percobaan ${attempts}/${MAX_RETRIES}).`);
                            attemptLoad(); 
                        } else {
                            console.error(`Gagal memuat gambar setelah ${MAX_RETRIES} percobaan. Menggunakan fallback warna.`);
                            resolve(null); // Gagal total, kembalikan null untuk fallback
                        }
                    };
                };

                attemptLoad();
            });
        }
        
        const quotesData = generateDecember2025Data();
        const totalImages = quotesData.length; 
        
        // --- Inisialisasi URL Gambar Acak Unik ---
        const randomIds = generateRandomPicsumIds(totalImages);
        const imageUrls = randomIds.map(id => 
            `https://picsum.photos/id/${id}/${DEFAULT_WIDTH}/${DEFAULT_HEIGHT}`
        );
        // --- Akhir Inisialisasi ---


        // --- Event listeners untuk kontrol ---
        document.getElementById('fontSizeEn').addEventListener('input', () => updatePreview(0));
        document.getElementById('fontSizeId').addEventListener('input', () => updatePreview(0));
        document.getElementById('textColor').addEventListener('input', () => updatePreview(0));
        document.getElementById('shadowColor').addEventListener('input', () => updatePreview(0));
        document.getElementById('bgContrast').addEventListener('input', () => updatePreview(0));
        document.getElementById('bgHue').addEventListener('input', () => updatePreview(0));
        document.getElementById('brandText').addEventListener('input', () => updatePreview(0));
        document.getElementById('logoSize').addEventListener('input', () => updatePreview(0));


        /**
         * Memecah teks menjadi baris
         */
        function wrapText(context, text, maxWidth) {
            const words = text.split(' ');
            let lines = [];
            let currentLine = words[0] || '';

            for (let i = 1; i < words.length; i++) {
                const word = words[i];
                const width = context.measureText(currentLine + " " + word).width;
                if (width < maxWidth) {
                    currentLine += " " + word;
                } else {
                    lines.push(currentLine);
                    currentLine = word;
                }
            }
            lines.push(currentLine);
            return lines;
        }

        /**
         * Menggambar overlay teks (termasuk logo, pesan, dan tanggal)
         */
        function drawTextOverlay(context, bgImg, data) {
            const bgW = DEFAULT_WIDTH;
            const bgH = DEFAULT_HEIGHT;
            
            const mainFontSize = parseInt(document.getElementById('fontSizeEn').value) || 48;
            const dateFontSize = parseInt(document.getElementById('fontSizeId').value) || 28;
            const textColor = document.getElementById('textColor').value;
            const shadowColor = document.getElementById('shadowColor').value;
            const brandText = document.getElementById('brandText').value; 
            const logoSize = parseInt(document.getElementById('logoSize').value) || 60; 
            
            const contrastValue = parseFloat(document.getElementById('bgContrast').value) || 1.0;
            const hueValue = parseInt(document.getElementById('bgHue').value) || 0;
            
            const padding = 60; 
            const maxWidth = bgW - (padding * 2);
            
            context.clearRect(0, 0, bgW, bgH);

            // Draw background
            const isBgLoaded = bgImg && bgImg.complete && bgImg.naturalWidth !== 0;

            if (isBgLoaded) {
                context.filter = `contrast(${contrastValue}) hue-rotate(${hueValue}deg)`;
                context.drawImage(bgImg, 0, 0, bgW, bgH);
                context.fillStyle = 'rgba(0, 0, 0, 0.5)'; // Overlay gelap
                context.fillRect(0, 0, bgW, bgH);
                context.filter = 'none'; // Hapus filter
            } else {
                // Fallback to gradient
                const gradient = context.createLinearGradient(0, 0, bgW, bgH);
                gradient.addColorStop(0, '#667eea');
                gradient.addColorStop(1, '#764ba2');
                context.fillStyle = gradient;
                context.fillRect(0, 0, bgW, bgH);
            }
            
            // --- Draw Logo and Brand Text in Top Right ---
            const brandPadding = 40; 
            const logoY = brandPadding;

            context.fillStyle = '#ffffff';
            const brandFontSize = 28;
            context.font = `bold ${brandFontSize}px Segoe UI, sans-serif`;
            const textWidth = context.measureText(brandText).width;
            
            const currentLogoSize = logoSize;

            const totalWidth = logoLoaded ? (currentLogoSize + 15 + textWidth) : textWidth;
            const logoX = bgW - brandPadding - totalWidth;
            
            // Draw logo if loaded 
            if (logoLoaded) {
                context.shadowColor = shadowColor;
                context.shadowBlur = 5;
                context.shadowOffsetX = 2;
                context.shadowOffsetY = 2;
                context.drawImage(logoImage, logoX, logoY, currentLogoSize, currentLogoSize);
                context.shadowColor = 'transparent'; 
                context.shadowBlur = 0;
                context.shadowOffsetX = 0;
                context.shadowOffsetY = 0;
            }

            // Draw brand text (to the right of logo)
            context.shadowColor = shadowColor;
            context.shadowBlur = 5;
            context.shadowOffsetX = 2;
            context.shadowOffsetY = 2;

            context.textAlign = 'left';
            context.textBaseline = 'middle';
            const brandTextY = logoY + currentLogoSize / 2;
            const brandTextX = logoLoaded ? (logoX + currentLogoSize + 15) : logoX;
            context.fillText(brandText, brandTextX, brandTextY);
            
            context.shadowColor = 'transparent';
            context.shadowBlur = 0;
            context.shadowOffsetX = 0;
            context.shadowOffsetY = 0;
            // --- Akhir Draw Logo and Brand Text ---


            // --- Draw Main Message and Date Text in Center ---
            context.textAlign = 'center';
            context.textBaseline = 'middle';
            
            // 1. Calculate space for Message
            context.font = `bold ${mainFontSize}px 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif`;
            const linesMessage = wrapText(context, data.message, maxWidth);
            const lineHeightMessage = mainFontSize * 1.4;
            const totalTextHeightMessage = linesMessage.length * lineHeightMessage;

            // 2. Calculate space for Date (Tanggal)
            context.font = `${dateFontSize}px 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif`; 
            const linesDate = wrapText(context, data.date, maxWidth); 
            const lineHeightDate = dateFontSize * 1.4;
            const totalTextHeightDate = linesDate.length * lineHeightDate;

            const spacing = 40; 
            const totalTextHeight = totalTextHeightMessage + spacing + totalTextHeightDate;

            let startY = (bgH - totalTextHeight) / 2;
            
            context.shadowColor = shadowColor;
            context.shadowBlur = 10;
            context.shadowOffsetX = 3;
            context.shadowOffsetY = 3;
            
            // 3. Draw Message Text
            context.fillStyle = textColor;
            context.font = `bold ${mainFontSize}px 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif`;
            linesMessage.forEach((line, index) => {
                const yPos = startY + (index * lineHeightMessage) + (lineHeightMessage / 2);
                context.fillText(line, bgW / 2, yPos);
            });
            
            // 4. Update startY for Date Text
            startY += totalTextHeightMessage + spacing;

            // 5. Draw Date Text
            context.font = `${dateFontSize}px 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif`;
            linesDate.forEach((line, index) => {
                const yPos = startY + (index * lineHeightDate) + (lineHeightDate / 2);
                context.fillText(line, bgW / 2, yPos);
            });
            
            context.shadowColor = 'transparent';
            context.shadowBlur = 0;
            context.shadowOffsetX = 0;
            context.shadowOffsetY = 0;
        }


        /**
         * FUNGSI UNTUK UPDATE PREVIEW
         */
        async function updatePreview(index) {
            const initialUrl = imageUrls[index];
            const data = quotesData[index];
            
            document.getElementById('statusMessage').innerText = `Loading Preview Hari ke-${index + 1}/${totalImages} (Desember 2025)...`;

            // Gunakan mekanisme retry untuk memuat gambar
            const image = await loadImageWithRetry(initialUrl);

            if (image) {
                // Berhasil dimuat (setelah 1 atau lebih percobaan)
                drawTextOverlay(ctx, image, data);
                document.getElementById('statusMessage').innerText = `Preview Hari ke-${index + 1}/${totalImages} ditampilkan. (Tanggal: ${data.date})`;
            } else {
                // Gagal total (menggunakan null untuk memicu fallback warna)
                drawTextOverlay(ctx, null, data); 
                document.getElementById('statusMessage').innerText = `Gagal memuat gambar Hari ke-${index + 1} setelah ${MAX_RETRIES} percobaan. Menampilkan background fallback warna.`;
            }
        }

        /**
         * FUNGSI MULTI-DOWNLOAD DENGAN JSZip MENGGUNAKAN WORKER POOL CONTINUOUS
         */
        async function downloadAllImages() {
            const zip = new JSZip();
            let filesProcessed = 0;
            let fallbacksUsed = 0;
            const totalFiles = imageUrls.length;
            const KUALITAS_KOMPRESI = 0.8; 
            const MAX_CONCURRENT = 10; // Batas koneksi serentak 

            if (totalFiles === 0) {
                 alert("Tidak ada data kutipan untuk diproses.");
                 return;
            }

            document.getElementById('statusMessage').innerText = `Mulai memproses ${totalFiles} gambar... Harap tunggu. Proses akan berjalan mulus.`;

            // Array semua indeks yang perlu diproses (digunakan sebagai queue)
            const allIndices = Array.from({length: totalFiles}, (_, i) => i).reverse();

            /**
             * Fungsi pembantu untuk memuat, memproses, dan menambahkan satu file ke ZIP (mengembalikan Promise)
             */
            const processFile = (index) => {
                return new Promise(async (resolve) => {
                    const initialUrl = imageUrls[index];
                    const data = quotesData[index];

                    // Gunakan mekanisme retry
                    const image = await loadImageWithRetry(initialUrl);
                    const isFallback = (image === null);

                    const handleImageProcessing = (img, isFallback) => {
                        // 1. Buat kanvas baru di memori
                        const tempCanvas = document.createElement('canvas');
                        tempCanvas.width = DEFAULT_WIDTH;
                        tempCanvas.height = DEFAULT_HEIGHT;
                        const tempCtx = tempCanvas.getContext('2d');

                        // 2. Gambar overlay teks
                        drawTextOverlay(tempCtx, img, data); 
                        
                        // 3. Tentukan nama file
                        // Ambil 30 karakter pertama dari pesan utama untuk nama file
                        const messageText = data.message.substring(0, 30).replace(/[^a-zA-Z0-9]/g, '_').trim(); 
                        const fallbackSuffix = isFallback ? '_FALLBACK' : '';
                        const fileName = `Desember_${index + 1}_${messageText}${fallbackSuffix}.jpeg`; 

                        // 4. Konversi ke Data URL JPEG dan ambil Base64
                        const dataUrl = tempCanvas.toDataURL('image/jpeg', KUALITAS_KOMPRESI);
                        const base64Data = dataUrl.split(',')[1];
                        zip.file(fileName, base64Data, {base64: true});

                        filesProcessed++;
                        if (isFallback) fallbacksUsed++;
                        
                        // PENTING: Update status secara kontinyu
                        document.getElementById('statusMessage').innerText = `Memproses... ${filesProcessed}/${totalFiles} selesai (Sukses: ${filesProcessed - fallbacksUsed}, Fallback: ${fallbacksUsed}).`;

                        resolve(); 
                    };

                    handleImageProcessing(image, isFallback);
                });
            };
            
            // --- LOGIKA WORKER POOL CONTINUOUS ---

            // Fungsi Worker: Mengambil tugas (indeks) dari queue hingga queue kosong
            const worker = async () => {
                let index;
                // Selama masih ada indeks di array, ambil dan proses
                while ((index = allIndices.pop()) !== undefined) {
                    await processFile(index);
                }
            };
            
            // Jalankan sejumlah worker (10) serentak
            const workers = Array(MAX_CONCURRENT).fill(null).map(() => worker());

            // Tunggu hingga semua pekerja menyelesaikan semua tugas
            await Promise.all(workers);
            
            // --- AKHIR LOGIKA WORKER POOL ---

            // 6. Generate dan Download ZIP setelah semua file diproses
            zip.generateAsync({type:"blob"})
            .then(function(content) {
                saveAs(content, "31_Penyemangat_Lidan_Psikologi_Desember_2025.zip");
                document.getElementById('statusMessage').innerText = `âœ… Selesai! File ZIP berisi ${totalFiles} gambar berhasil diunduh.`;
            });
        }

        // Initial render (Hari ke-1)
        updatePreview(0);
    </script>
</body>
</html>